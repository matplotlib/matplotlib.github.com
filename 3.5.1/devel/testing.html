
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Testing &#8212; Matplotlib 3.5.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mpl.css?v3.5.1-31-g17b1fdcf22" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="canonical" href="https://matplotlib.org/stable/devel/testing.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Matplotlib 3.5.1 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Writing documentation" href="documenting_mpl.html" />
    <link rel="prev" title="Setting up Matplotlib for development" href="development_setup.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-55954603-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo2.svg" class="logo" alt="logo">
</a>      


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        
<ul id="navbar-main-elements" class="navbar-nav">
  <li class="nav-item">
    <a class="reference internal nav-link" href="../plot_types/index.html">Plot types</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../gallery/index.html">Examples</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../tutorials/index.html">Tutorials</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../api/index.html">Reference</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../users/index.html">User guide</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="index.html">Develop</a>
  </li>
  <li class="nav-item">
    <a class="reference internal nav-link" href="../users/release_notes.html">Release notes</a>
  </li>
</ul>

      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        
      <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://gitter.im/matplotlib" rel="noopener" target="_blank" title="gitter">
            <span><i class="fab fa-gitter"></i></span>
            <label class="sr-only">gitter</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://discourse.matplotlib.org" rel="noopener" target="_blank" title="discourse">
            <span><i class="fab fa-discourse"></i></span>
            <label class="sr-only">discourse</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/matplotlib/matplotlib" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/matplotlib/" rel="noopener" target="_blank" title="twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="triage.html">
   Bug triaging and issue curation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="development_setup.html">
   Setting up Matplotlib for development
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="documenting_mpl.html">
   Writing documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="style_guide.html">
   Documentation style guide
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="gitwash/index.html">
   Working with
   <em>
    Matplotlib
   </em>
   source code
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="gitwash/git_intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gitwash/git_install.html">
     Install git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gitwash/following_latest.html">
     Following the latest source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gitwash/patching.html">
     Making a patch
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="gitwash/git_development.html">
     Git for development
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="gitwash/forking_hell.html">
       Making your own copy (fork) of Matplotlib
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gitwash/set_up_fork.html">
       Set up your fork
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gitwash/configure_git.html">
       Configure git
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gitwash/development_workflow.html">
       Development workflow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gitwash/maintainer_workflow.html">
       Maintainer workflow
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gitwash/git_resources.html">
     git resources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gitwash/dot2_dot3.html">
     Two and three dots in difference specs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coding_guide.html">
   Pull request guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="release_guide.html">
   Release guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dependencies.html">
   Dependencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="min_dep_policy.html">
   Minimum version of dependencies policy
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="MEP/index.html">
   Matplotlib Enhancement Proposals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/template.html">
     MEP Template
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP08.html">
     MEP8: PEP8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP09.html">
     MEP9: Global interaction manager
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP10.html">
     MEP10: Docstring consistency
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP11.html">
     MEP11: Third-party dependencies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP12.html">
     MEP12: Improve Gallery and Examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP13.html">
     MEP13: Use properties for Artists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP14.html">
     MEP14: Text handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP15.html">
     MEP15: Fix axis autoscaling when limits are specified for one axis only
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP19.html">
     MEP19: Continuous Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP21.html">
     MEP21: color and cm refactor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP22.html">
     MEP22: Toolbar rewrite
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP23.html">
     MEP23: Multiple Figures per GUI window
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP24.html">
     MEP24: Negative radius in polar plots
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP25.html">
     MEP25: Serialization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP26.html">
     MEP26: Artist styling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP27.html">
     MEP27: Decouple pyplot from backends
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP28.html">
     MEP28: Remove Complexity from Axes.boxplot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="MEP/MEP29.html">
     MEP29: Text light markup
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="license.html">
   Licenses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="color_changes.html">
   Default color changes
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#requirements">
   Requirements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-tests">
   Running the tests
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-a-simple-test">
   Writing a simple test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-data-in-tests">
   Random data in tests
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-an-image-comparison-test">
   Writing an image comparison test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-new-module-in-matplotlib-tests">
   Creating a new module in matplotlib.tests
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-github-actions-for-ci">
   Using GitHub Actions for CI
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-tox">
   Using tox
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-old-versions-of-matplotlib">
   Building old versions of Matplotlib
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#testing-released-versions-of-matplotlib">
   Testing released versions of Matplotlib
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install-additional-dependencies">
     Install additional dependencies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#obtain-the-reference-images">
     Obtain the reference images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-the-tests">
     Run the tests
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="testing">
<span id="id1"></span><h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p>Matplotlib uses the <a class="reference external" href="http://doc.pytest.org/en/latest/">pytest</a> framework.</p>
<p>The tests are in <code class="file docutils literal notranslate"><span class="pre">lib/matplotlib/tests</span></code>, and customizations to the pytest
testing infrastructure are in <a class="reference internal" href="../api/testing_api.html#module-matplotlib.testing" title="matplotlib.testing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib.testing</span></code></a>.</p>
<section id="requirements">
<span id="testing-requirements"></span><h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>To run the tests you will need to
<a class="reference internal" href="development_setup.html#installing-for-devs"><span class="std std-ref">set up Matplotlib for development</span></a>. Note in
particular the <a class="reference internal" href="dependencies.html#test-dependencies"><span class="std std-ref">additional dependencies</span></a> for testing.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will assume that you want to run the tests in a development setup.</p>
<p>While you can run the tests against a regular installed version of
Matplotlib, this is a far less common use case. You still need the
<a class="reference internal" href="dependencies.html#test-dependencies"><span class="std std-ref">additional dependencies</span></a> for testing.
You have to additionally get the reference images from the repository,
because they are not distributed with pre-built Matplotlib packages.</p>
</div>
</section>
<section id="running-the-tests">
<h2>Running the tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h2>
<p>In the root directory of your development repository run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span>
</pre></div>
</div>
<p>pytest can be configured via a lot of <a class="reference external" href="http://doc.pytest.org/en/latest/usage.html">command-line parameters</a>. Some
particularly useful ones are:</p>
<table class="table">
<colgroup>
<col style="width: 46%" />
<col style="width: 54%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-v</span></code> or <code class="docutils literal notranslate"><span class="pre">--verbose</span></code></p></td>
<td><p>Be more verbose</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">NUM</span></code></p></td>
<td><p>Run tests in parallel over NUM
processes (requires <a class="reference external" href="https://pypi.org/project/pytest-xdist/">pytest-xdist</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--capture=no</span></code> or <code class="docutils literal notranslate"><span class="pre">-s</span></code></p></td>
<td><p>Do not capture stdout</p></td>
</tr>
</tbody>
</table>
<p>To run a single test from the command line, you can provide a file path,
optionally followed by the function separated by two colons, e.g., (tests do
not need to be installed, but Matplotlib should be):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="n">lib</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">test_simplification</span><span class="o">.</span><span class="n">py</span><span class="p">::</span><span class="n">test_clipping</span>
</pre></div>
</div>
</section>
<section id="writing-a-simple-test">
<h2>Writing a simple test<a class="headerlink" href="#writing-a-simple-test" title="Permalink to this headline">¶</a></h2>
<p>Many elements of Matplotlib can be tested using standard tests. For
example, here is a test from <code class="file docutils literal notranslate"><span class="pre">matplotlib/tests/test_basic.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_simple</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    very simple example test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Pytest determines which functions are tests by searching for files whose names
begin with <code class="docutils literal notranslate"><span class="pre">&quot;test_&quot;</span></code> and then within those files for functions beginning with
<code class="docutils literal notranslate"><span class="pre">&quot;test&quot;</span></code> or classes beginning with <code class="docutils literal notranslate"><span class="pre">&quot;Test&quot;</span></code>.</p>
<p>Some tests have internal side effects that need to be cleaned up after their
execution (such as created figures or modified <a class="reference internal" href="../api/matplotlib_configuration_api.html#matplotlib.rcParams" title="matplotlib.rcParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rcParams</span></code></a>). The pytest fixture
<code class="docutils literal notranslate"><span class="pre">matplotlib.testing.conftest.mpl_test_settings</span></code> will automatically clean
these up; there is no need to do anything further.</p>
</section>
<section id="random-data-in-tests">
<h2>Random data in tests<a class="headerlink" href="#random-data-in-tests" title="Permalink to this headline">¶</a></h2>
<p>Random data is a very convenient way to generate data for examples,
however the randomness is problematic for testing (as the tests
must be deterministic!).  To work around this set the seed in each test.
For numpy use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">19680801</span><span class="p">)</span>
</pre></div>
</div>
<p>The seed is John Hunter's birthday.</p>
</section>
<section id="writing-an-image-comparison-test">
<h2>Writing an image comparison test<a class="headerlink" href="#writing-an-image-comparison-test" title="Permalink to this headline">¶</a></h2>
<p>Writing an image-based test is only slightly more difficult than a simple
test. The main consideration is that you must specify the &quot;baseline&quot;, or
expected, images in the <a class="reference internal" href="../api/testing_api.html#matplotlib.testing.decorators.image_comparison" title="matplotlib.testing.decorators.image_comparison"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image_comparison</span></code></a>
decorator. For example, this test generates a single image and automatically
tests it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.testing.decorators</span> <span class="kn">import</span> <span class="n">image_comparison</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="nd">@image_comparison</span><span class="p">(</span><span class="n">baseline_images</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;line_dashes&#39;</span><span class="p">],</span> <span class="n">remove_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">extensions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;png&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test_line_dashes</span><span class="p">():</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>The first time this test is run, there will be no baseline image to compare
against, so the test will fail.  Copy the output images (in this case
<code class="file docutils literal notranslate"><span class="pre">result_images/test_lines/test_line_dashes.png</span></code>) to the correct
subdirectory of <code class="file docutils literal notranslate"><span class="pre">baseline_images</span></code> tree in the source directory (in this
case <code class="file docutils literal notranslate"><span class="pre">lib/matplotlib/tests/baseline_images/test_lines</span></code>).  Put this new
file under source code revision control (with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>).  When rerunning
the tests, they should now pass.</p>
<p>Baseline images take a lot of space in the Matplotlib repository.
An alternative approach for image comparison tests is to use the
<a class="reference internal" href="../api/testing_api.html#matplotlib.testing.decorators.check_figures_equal" title="matplotlib.testing.decorators.check_figures_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_figures_equal</span></code></a> decorator, which should be
used to decorate a function taking two <a class="reference internal" href="../api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Figure</span></code></a> parameters and draws the same
images on the figures using two different methods (the tested method and the
baseline method).  The decorator will arrange for setting up the figures and
then collect the drawn results and compare them.</p>
<p>See the documentation of <a class="reference internal" href="../api/testing_api.html#matplotlib.testing.decorators.image_comparison" title="matplotlib.testing.decorators.image_comparison"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image_comparison</span></code></a> and
<a class="reference internal" href="../api/testing_api.html#matplotlib.testing.decorators.check_figures_equal" title="matplotlib.testing.decorators.check_figures_equal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_figures_equal</span></code></a> for additional information
about their use.</p>
</section>
<section id="creating-a-new-module-in-matplotlib-tests">
<h2>Creating a new module in matplotlib.tests<a class="headerlink" href="#creating-a-new-module-in-matplotlib-tests" title="Permalink to this headline">¶</a></h2>
<p>We try to keep the tests categorized by the primary module they are
testing.  For example, the tests related to the <code class="docutils literal notranslate"><span class="pre">mathtext.py</span></code> module
are in <code class="docutils literal notranslate"><span class="pre">test_mathtext.py</span></code>.</p>
</section>
<section id="using-github-actions-for-ci">
<h2>Using GitHub Actions for CI<a class="headerlink" href="#using-github-actions-for-ci" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://docs.github.com/en/actions">GitHub Actions</a> is a hosted CI system
&quot;in the cloud&quot;.</p>
<p>GitHub Actions is configured to receive notifications of new commits to GitHub
repos and to run builds or tests when it sees these new commits. It looks for a
YAML files in <code class="docutils literal notranslate"><span class="pre">.github/workflows</span></code> to see how to test the project.</p>
<p>GitHub Actions is already enabled for the <a class="reference external" href="https://github.com/matplotlib/matplotlib/">main Matplotlib GitHub repository</a> -- for example, see <a class="reference external" href="https://github.com/matplotlib/matplotlib/actions?query=workflow%3ATests">the Tests
workflows</a>.</p>
<p>GitHub Actions should be automatically enabled for your personal Matplotlib
fork once the YAML workflow files are in it. It generally isn't necessary to
look at these workflows, since any pull request submitted against the main
Matplotlib repository will be tested.</p>
<p>You can see the GitHub Actions results at
<a class="reference external" href="https://github.com/your_GitHub_user_name/matplotlib/actions">https://github.com/your_GitHub_user_name/matplotlib/actions</a> -- here's <a class="reference external" href="https://github.com/QuLogic/matplotlib/actions">an
example</a>.</p>
</section>
<section id="using-tox">
<h2>Using tox<a class="headerlink" href="#using-tox" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://tox.readthedocs.io/en/latest/">Tox</a> is a tool for running tests
against multiple Python environments, including multiple versions of Python
(e.g., 3.6, 3.7) and even different Python implementations altogether
(e.g., CPython, PyPy, Jython, etc.), as long as all these versions are
available on your system's $PATH (consider using your system package manager,
e.g. apt-get, yum, or Homebrew, to install them).</p>
<p>tox makes it easy to determine if your working copy introduced any
regressions before submitting a pull request. Here's how to use it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install tox
$ tox
</pre></div>
</div>
<p>You can also run tox on a subset of environments:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tox -e py37,py38
</pre></div>
</div>
<p>Tox processes everything serially so it can take a long time to test
several environments. To speed it up, you might try using a new,
parallelized version of tox called <code class="docutils literal notranslate"><span class="pre">detox</span></code>. Give this a try:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install -U -i http://pypi.testrun.org detox
$ detox
</pre></div>
</div>
<p>Tox is configured using a file called <code class="docutils literal notranslate"><span class="pre">tox.ini</span></code>. You may need to
edit this file if you want to add new environments to test (e.g.,
<code class="docutils literal notranslate"><span class="pre">py33</span></code>) or if you want to tweak the dependencies or the way the
tests are run. For more info on the <code class="docutils literal notranslate"><span class="pre">tox.ini</span></code> file, see the <a class="reference external" href="https://tox.readthedocs.io/en/latest/config.html">Tox
Configuration Specification</a>.</p>
</section>
<section id="building-old-versions-of-matplotlib">
<h2>Building old versions of Matplotlib<a class="headerlink" href="#building-old-versions-of-matplotlib" title="Permalink to this headline">¶</a></h2>
<p>When running a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code> to see which commit introduced a certain bug,
you may (rarely) need to build very old versions of Matplotlib.  The following
constraints need to be taken into account:</p>
<ul class="simple">
<li><p>Matplotlib 1.3 (or earlier) requires numpy 1.8 (or earlier).</p></li>
</ul>
</section>
<section id="testing-released-versions-of-matplotlib">
<h2>Testing released versions of Matplotlib<a class="headerlink" href="#testing-released-versions-of-matplotlib" title="Permalink to this headline">¶</a></h2>
<p>Running the tests on an installation of a released version (e.g. PyPI package
or conda package) also requires additional setup.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For an end-user, there is usually no need to run the tests on released
versions of Matplotlib. Official releases are tested before publishing.</p>
</div>
<section id="install-additional-dependencies">
<h3>Install additional dependencies<a class="headerlink" href="#install-additional-dependencies" title="Permalink to this headline">¶</a></h3>
<p>Install the <a class="reference internal" href="dependencies.html#test-dependencies"><span class="std std-ref">additional dependencies for testing</span></a>.</p>
</section>
<section id="obtain-the-reference-images">
<h3>Obtain the reference images<a class="headerlink" href="#obtain-the-reference-images" title="Permalink to this headline">¶</a></h3>
<p>Many tests compare the plot result against reference images. The reference
images are not part of the regular packaged versions (pip wheels or conda
packages). If you want to run tests with reference images, you need to obtain
the reference images matching the version of Matplotlib you want to test.</p>
<p>To do so, either download the matching source distribution
<code class="docutils literal notranslate"><span class="pre">matplotlib-X.Y.Z.tar.gz</span></code> from <a class="reference external" href="https://pypi.org/project/matplotlib/">PyPI</a>
or alternatively, clone the git repository and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">vX.Y.Z</span></code>. Copy
the folder <code class="file docutils literal notranslate"><span class="pre">lib/matplotlib/tests/baseline_images</span></code> to the folder
<code class="file docutils literal notranslate"><span class="pre">matplotlib/tests</span></code> of your the matplotlib installation to test.
The correct target folder can be found using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;import matplotlib.tests; print(matplotlib.tests.__file__.rsplit(&#39;/&#39;, 1)[0])&quot;</span>
</pre></div>
</div>
<p>An analogous copying of <code class="file docutils literal notranslate"><span class="pre">lib/mpl_toolkits/tests/baseline_images</span></code>
is necessary for testing <code class="docutils literal notranslate"><span class="pre">mpl_toolkits</span></code>.</p>
</section>
<section id="run-the-tests">
<h3>Run the tests<a class="headerlink" href="#run-the-tests" title="Permalink to this headline">¶</a></h3>
<p>To run the all the tests on your installed version of Matplotlib:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span> <span class="o">--</span><span class="n">pyargs</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">tests</span>
</pre></div>
</div>
<p>The test discovery scope can be narrowed to single test modules or even single
functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span> <span class="o">--</span><span class="n">pyargs</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">tests</span><span class="o">.</span><span class="n">test_simplification</span><span class="o">.</span><span class="n">py</span><span class="p">::</span><span class="n">test_clipping</span>
</pre></div>
</div>
</section>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
<div id="unreleased-message"> You are reading an old version of the documentation (v3.5.1).  For the latest version see <a href="https://matplotlib.org/stable/devel/testing.html">https://matplotlib.org/stable/devel/testing.html</a></div>
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2002 - 2012 John Hunter, Darren Dale, Eric Firing, Michael Droettboom and the Matplotlib development team; 2012 - 2022 The Matplotlib development team.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>