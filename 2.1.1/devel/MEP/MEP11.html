<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>MEP11: Third-party dependencies — Matplotlib 2.1.1 documentation</title>
<link href="../../_static/mpl.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/gallery.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
<script src="../../_static/jquery.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<link href="../../_static/opensearch.xml" rel="search" title="Search within Matplotlib 2.1.1 documentation" type="application/opensearchdescription+xml"/>
<link href="../../_static/favicon.ico" rel="shortcut icon"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="../../index.html" rel="top" title="Matplotlib 2.1.1 documentation"/>
<link href="index.html" rel="up" title="Matplotlib Enhancement Proposals"/>
<link href="MEP12.html" rel="next" title="MEP12: Improve Gallery and Examples"/>
<link href="MEP10.html" rel="prev" title="MEP10: Docstring consistency"/>
<link href="https://matplotlib.org/devel/MEP/MEP11.html" rel="canonical"/></head>
<body><div id="old-version-banner">
            You are reading documentation for a static version of Matplotlib.
            <a href="https://matplotlib.org/devel/MEP/MEP11.html">This page may have been updated.</a>
</div>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px; position: relative;">
<a href="../../index.html"><img alt="matplotlib" border="0" src="../../_static/logo2.svg" width="540px"/></a>
<!-- The "Fork me on github" ribbon -->
<div id="forkongithub"><a href="https://github.com/matplotlib/matplotlib">Fork me on GitHub</a></div>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="MEP12.html" title="MEP12: Improve Gallery and Examples">next</a> |</li>
<li class="right">
<a accesskey="P" href="MEP10.html" title="MEP10: Docstring consistency">previous</a> |</li>
<li><a href="../../index.html">home</a>| </li>
<li><a href="../../gallery/index.html">examples</a>| </li>
<li><a href="../../tutorials/index.html">tutorials</a>| </li>
<li><a href="../../api/pyplot_summary.html">pyplot</a>| </li>
<li><a href="../../contents.html">docs</a> »</li>
<li><a href="../index.html">The Matplotlib Developers’ Guide</a> »</li>
<li><a accesskey="U" href="index.html">Matplotlib Enhancement Proposals</a> »</li>
</ul>
</div>
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper"><a href="https://www.numfocus.org">
<image src="https://img.shields.io/badge/powered%20by-NumFOCUS-orange.svg?style=flat&amp;colorA=E1523D&amp;colorB=007D8A">
</image></a>
<br/>
<a href="http://depsy.org/package/python/matplotlib">
<img src="../../_static/depsy_badge.svg"/>
</a>
<br/>

Travis-CI: <a href="https://travis-ci.org/matplotlib/matplotlib">
<img src="https://travis-ci.org/matplotlib/matplotlib.svg?branch=master"/>
</a>
<br/>
<h3><a href="../../contents.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">MEP11: Third-party dependencies</a><ul>
<li><a class="reference internal" href="#status">Status</a></li>
<li><a class="reference internal" href="#branches-and-pull-requests">Branches and Pull requests</a></li>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#detailed-description">Detailed description</a><ul>
<li><a class="reference internal" href="#current-behavior">Current behavior</a></li>
<li><a class="reference internal" href="#desired-behavior">Desired behavior</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation">Implementation</a></li>
<li><a class="reference internal" href="#backward-compatibility">Backward compatibility</a></li>
<li><a class="reference internal" href="#alternatives">Alternatives</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="../../contents.html">Documentation overview</a><ul>
<li><a href="../index.html">The Matplotlib Developers’ Guide</a><ul>
<li><a href="index.html">Matplotlib Enhancement Proposals</a><ul>
<li>Previous: <a href="MEP10.html" title="previous chapter">MEP10: Docstring consistency</a></li>
<li>Next: <a href="MEP12.html" title="next chapter">MEP12: Improve Gallery and Examples</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
<div aria-label="source link" role="note">
<h3>This Page</h3>
<ul class="this-page-menu">
<li><a href="../../_sources/devel/MEP/MEP11.rst.txt" rel="nofollow">Show Source</a></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3>Quick search</h3>
<form action="../../search.html" class="search" method="get">
<div><input name="q" type="text"/></div>
<div><input type="submit" value="Go"/></div>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body">
<div class="section" id="mep11-third-party-dependencies">
<h1>MEP11: Third-party dependencies<a class="headerlink" href="#mep11-third-party-dependencies" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#status" id="id1">Status</a></li>
<li><a class="reference internal" href="#branches-and-pull-requests" id="id2">Branches and Pull requests</a></li>
<li><a class="reference internal" href="#abstract" id="id3">Abstract</a></li>
<li><a class="reference internal" href="#detailed-description" id="id4">Detailed description</a><ul>
<li><a class="reference internal" href="#current-behavior" id="id5">Current behavior</a></li>
<li><a class="reference internal" href="#desired-behavior" id="id6">Desired behavior</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation" id="id7">Implementation</a></li>
<li><a class="reference internal" href="#backward-compatibility" id="id8">Backward compatibility</a></li>
<li><a class="reference internal" href="#alternatives" id="id9">Alternatives</a></li>
</ul>
</div>
<p>This MEP attempts to improve the way in which third-party dependencies
in matplotlib are handled.</p>
<div class="section" id="status">
<h2><a class="toc-backref" href="#id1">Status</a><a class="headerlink" href="#status" title="Permalink to this headline">¶</a></h2>
<p><strong>Completed</strong> – needs to be merged</p>
</div>
<div class="section" id="branches-and-pull-requests">
<h2><a class="toc-backref" href="#id2">Branches and Pull requests</a><a class="headerlink" href="#branches-and-pull-requests" title="Permalink to this headline">¶</a></h2>
<p>#1157: Use automatic dependency resolution</p>
<p>#1290: Debundle pyparsing</p>
<p>#1261: Update six to 1.2</p>
</div>
<div class="section" id="abstract">
<h2><a class="toc-backref" href="#id3">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>One of the goals of matplotlib has been to keep it as easy to install
as possible.  To that end, some third-party dependencies are included
in the source tree and, under certain circumstances, installed
alongside matplotlib.  This MEP aims to resolve some problems with
that approach, bring some consistency, while continuing to make
installation convenient.</p>
<p>At the time that was initially done, <code class="xref py py-obj docutils literal"><span class="pre">setuptools</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">easy_install</span></code> and
<code class="xref py py-obj docutils literal"><span class="pre">PyPI</span></code> were not mature enough to be relied on.  However, at present,
we should be able to safely leverage the “modern” versions of those
tools, <code class="xref py py-obj docutils literal"><span class="pre">distribute</span></code> and <code class="xref py py-obj docutils literal"><span class="pre">pip</span></code>.</p>
<p>While matplotlib has dependencies on both Python libraries and C/C++
libraries, this MEP addresses only the Python libraries so as to not
confuse the issue.  C libraries represent a larger and mostly
orthogonal set of problems.</p>
</div>
<div class="section" id="detailed-description">
<h2><a class="toc-backref" href="#id4">Detailed description</a><a class="headerlink" href="#detailed-description" title="Permalink to this headline">¶</a></h2>
<p>matplotlib depends on the following third-party Python libraries:</p>
<blockquote>
<div><ul class="simple">
<li>Numpy</li>
<li>dateutil (pure Python)</li>
<li>pytz (pure Python)</li>
<li>six – required by dateutil (pure Python)</li>
<li>pyparsing (pure Python)</li>
<li>PIL (optional)</li>
<li>GUI frameworks: pygtk, gobject, tkinter, PySide, PyQt4, wx (all
optional, but one is required for an interactive GUI)</li>
</ul>
</div></blockquote>
<div class="section" id="current-behavior">
<h3><a class="toc-backref" href="#id5">Current behavior</a><a class="headerlink" href="#current-behavior" title="Permalink to this headline">¶</a></h3>
<p>When installing from source, a <code class="xref py py-obj docutils literal"><span class="pre">git</span></code> checkout or <code class="xref py py-obj docutils literal"><span class="pre">pip</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref py py-obj docutils literal"><span class="pre">setup.py</span></code> attempts to <code class="xref py py-obj docutils literal"><span class="pre">import</span> <span class="pre">numpy</span></code>.  If this fails, the
installation fails.</li>
<li>For each of <code class="xref py py-obj docutils literal"><span class="pre">dateutil</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">pytz</span></code> and <code class="xref py py-obj docutils literal"><span class="pre">six</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">setup.py</span></code> attempts to
import them (from the top-level namespace).  If that fails,
matplotlib installs its local copy of the library into the
top-level namespace.</li>
<li><code class="xref py py-obj docutils literal"><span class="pre">pyparsing</span></code> is always installed inside of the matplotlib
namespace.</li>
</ul>
</div></blockquote>
<p>This behavior is most surprising when used with <code class="xref py py-obj docutils literal"><span class="pre">pip</span></code>, because no
<code class="xref py py-obj docutils literal"><span class="pre">pip</span></code> dependency resolution is performed, even though it is likely to
work for all of these packages.</p>
<p>The fact that <code class="xref py py-obj docutils literal"><span class="pre">pyparsing</span></code> is installed in the matplotlib namespace has
reportedly (#1290) confused some users into thinking it is a
matplotlib-related module and import it from there rather than the
top-level.</p>
<p>When installing using the Windows installer, <code class="xref py py-obj docutils literal"><span class="pre">dateutil</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">pytz</span></code> and
<code class="xref py py-obj docutils literal"><span class="pre">six</span></code> are installed at the top-level <em>always</em>, potentially overwriting
already installed copies of those libraries.</p>
<p>TODO: Describe behavior with the OS-X installer.</p>
<p>When installing using a package manager (Debian, RedHat, MacPorts
etc.), this behavior actually does the right thing, and there are no
special patches in the matplotlib packages to deal with the fact that
we handle <code class="xref py py-obj docutils literal"><span class="pre">dateutil</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">pytz</span></code> and <code class="xref py py-obj docutils literal"><span class="pre">six</span></code> in this way.  However, care
should be taken that whatever approach we move to continues to work in
that context.</p>
<p>Maintaining these packages in the matplotlib tree and making sure they
are up-to-date is a maintenance burden.  Advanced new features that
may require a third-party pure Python library have a higher barrier to
inclusion because of this burden.</p>
</div>
<div class="section" id="desired-behavior">
<h3><a class="toc-backref" href="#id6">Desired behavior</a><a class="headerlink" href="#desired-behavior" title="Permalink to this headline">¶</a></h3>
<p>Third-party dependencies are downloaded and installed from their
canonical locations by leveraging <code class="xref py py-obj docutils literal"><span class="pre">pip</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">distribute</span></code> and <code class="xref py py-obj docutils literal"><span class="pre">PyPI</span></code>.</p>
<p><code class="xref py py-obj docutils literal"><span class="pre">dateutil</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">pytz</span></code>, and <code class="xref py py-obj docutils literal"><span class="pre">pyparsing</span></code> should be made into optional
dependencies – though obviously some features would fail if they
aren’t installed.  This will allow the user to decide whether they
want to bother installing a particular feature.</p>
</div>
</div>
<div class="section" id="implementation">
<h2><a class="toc-backref" href="#id7">Implementation</a><a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>For installing from source, and assuming the user has all of the
C-level compilers and dependencies, this can be accomplished fairly
easily using <code class="xref py py-obj docutils literal"><span class="pre">distribute</span></code> and following the instructions <a class="reference external" href="https://pypi.python.org/pypi/distribute">here</a>.  The only anticipated
change to the matplotlib library code will be to import <code class="xref py py-obj docutils literal"><span class="pre">pyparsing</span></code>
from the top-level namespace rather than from within matplotlib.  Note
that <code class="xref py py-obj docutils literal"><span class="pre">distribute</span></code> will also allow us to remove the direct dependency
on <code class="xref py py-obj docutils literal"><span class="pre">six</span></code>, since it is, strictly speaking, only a direct dependency of
<code class="xref py py-obj docutils literal"><span class="pre">dateutil</span></code>.</p>
<p>For binary installations, there are a number of alternatives (here
ordered from best/hardest to worst/easiest):</p>
<blockquote>
<div><ol class="arabic simple">
<li>The distutils wininst installer allows a post-install script to
run.  It might be possible to get this script to run <code class="xref py py-obj docutils literal"><span class="pre">pip</span></code> to
install the other dependencies.  (See <a class="reference external" href="http://grokbase.com/t/python/distutils-sig/109bdnfhp4/distutils-ann-setuptools-post-install-script-for-bdist-wininst">this thread</a>
for someone who has trod that ground before).</li>
<li>Continue to ship <code class="xref py py-obj docutils literal"><span class="pre">dateutil</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">pytz</span></code>, <code class="xref py py-obj docutils literal"><span class="pre">six</span></code> and <code class="xref py py-obj docutils literal"><span class="pre">pyparsing</span></code> in
our installer, but use the post-install-script to install them
<em>only</em> if they can not already be found.</li>
<li>Move all of these packages inside a (new) <code class="xref py py-obj docutils literal"><span class="pre">matplotlib.extern</span></code>
namespace so it is clear for outside users that these are
external packages.  Add some conditional imports in the core
matplotlib codebase so <code class="xref py py-obj docutils literal"><span class="pre">dateutil</span></code> (at the top-level) is tried
first, and failing that <code class="xref py py-obj docutils literal"><span class="pre">matplotlib.extern.dateutil</span></code> is used.</li>
</ol>
</div></blockquote>
<p>2 and 3 are undesirable as they still require maintaining copies of
these packages in our tree – and this is exacerbated by the fact that
they are used less – only in the binary installers.  None of these 3
approaches address Numpy, which will still have to be manually
installed using an installer.</p>
<p>TODO: How does this relate to the Mac OS-X installer?</p>
</div>
<div class="section" id="backward-compatibility">
<h2><a class="toc-backref" href="#id8">Backward compatibility</a><a class="headerlink" href="#backward-compatibility" title="Permalink to this headline">¶</a></h2>
<p>At present, matplotlib can be installed from source on a machine
without the third party dependencies and without an internet
connection.  After this change, an internet connection (and a working
PyPI) will be required to install matplotlib for the first time.
(Subsequent matplotlib updates or development work will run without
accessing the network).</p>
</div>
<div class="section" id="alternatives">
<h2><a class="toc-backref" href="#id9">Alternatives</a><a class="headerlink" href="#alternatives" title="Permalink to this headline">¶</a></h2>
<p>Distributing binary <code class="xref py py-obj docutils literal"><span class="pre">eggs</span></code> doesn’t feel like a usable solution.  That
requires getting <code class="xref py py-obj docutils literal"><span class="pre">easy_install</span></code> installed first, and Windows users
generally prefer the well known <code class="xref py py-obj docutils literal"><span class="pre">exe</span></code> or <code class="xref py py-obj docutils literal"><span class="pre">msi</span></code> installer that works
out of the box.</p>
</div>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="footer">
        © Copyright 2002 - 2012 John Hunter, Darren Dale, Eric Firing, Michael Droettboom and the Matplotlib development team; 2012 - 2017 The Matplotlib development team.
      Last updated on Dec 11, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.5.
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55954603-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
<footer>
<!--Flipcause Integration v3.0// Flipcause Integration Instructions:
Install the following code block once in the website Header (after <head> tag) -->
<style>

.fc-black_overlay{
display:none; position: fixed; z-index:1000001; top: 0%;left: 0%;width: 100%;height: 100%;
background-color: black; filter: alpha(opacity=50); cursor:pointer; opacity:0.5;
}

.fc-white_content {
opacity:1; display:none; margin-top: -320px; margin-left: -485px; width:970px; height:640px;
position:fixed; top:50%; left:50%; border: none;z-index:1000002;overflow: auto;
}

.fc-main-box{
opacity:1; display:none; margin:15px auto 0 auto; width:930px; position:relative; z-index:1000003;
}

.fc-widget_close{
opacity:1; content:url(http://i1338.photobucket.com/albums/o691/WeCause/X_zpse4a7e538.png);
position:absolute; z-index=1000004; right:-16px; top:-16px; display:block; cursor:pointer;
}

.floating_button{
display: block; margin-top: 0px; margin-left: 0px; width:auto ; height: auto;
position:fixed; z-index:999999; overflow: auto;
}

@keyframes backfadesin {
   from { opacity:0; }
   to {opacity:.5;}
}

@-moz-keyframes backfadesin {
    from { opacity:0; }
    to {opacity:.5;}
}

@-webkit-keyframes backfadesin {
    from { opacity:0; }
    to {opacity:.5;}
}

@-o-keyframes backfadesin {
    from { opacity:0; }
    to {opacity:.5;}
}


@-ms-keyframes backfadesin {
    from { opacity:0; }
    to {opacity:.5;}
}

@keyframes fadesin {
   0%{ opacity:0; }
   50%{ opacity:0; }
   75% {opacity: 0; transform: translateY(20px);}
   100% {opacity: 1; transform: translateY(0);}
}

@-moz-keyframes fadesin {
   0%{ opacity:0; }
   50%{ opacity:0; }
   75% {opacity: 0; -moz-transform: translateY(20px);}
   100% {opacity: 1; -moz-transform: translateY(0);}
}

@-webkit-keyframes fadesin {
   0%{ opacity:0; }
   50%{ opacity:0; }
   75% {opacity: 0; -webkit-transform: translateY(20px);}
   100% {opacity: 1; -webkit-transform: translateY(0);}
}

@-o-keyframes fadesin {
   0%{ opacity:0; }
   50%{ opacity:0; }
   75% {opacity: 0; -o-transform: translateY(20px);}
   100% {opacity: 1; -o-transform: translateY(0);}
}

@-ms-keyframes fadesin {
   0%{ opacity:0; }
   50%{ opacity:0; }
   75% {opacity: 0; -ms-transform: translateY(20px);}
   100% {opacity: 1; -ms-transform: translateY(0);}
}

</style>
<script>

function open_window(cause_id) {
var  protocol=String(document.location.protocol);
var new_url;
if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
new_url="https://www.flipcause.com/widget/"+cause_id
window.open(new_url);
}

else {
document.getElementById("fc-fade").style.display = "block";
document.getElementById("fc-fade").style.webkitAnimation = "backfadesin 1s";
document.getElementById("fc-fade").style.animation = "backfadesin 1s";
document.getElementById("fc-fade").style.mozAnimation = "backfadesin 1s";
document.getElementById("fc-light").style.display = "block";
document.getElementById("fc-light").style.webkitAnimation = "fadesin 1.5s";
document.getElementById("fc-light").style.animation = "fadesin 1.5s";
document.getElementById("fc-light").style.mozAnimation = "fadesin 1.5s";
document.getElementById("fc-main").style.display = "block";
document.getElementById("fc-main").style.webkitAnimation = "fadesin 1.5s";
document.getElementById("fc-main").style.animation = "fadesin 1.5s";
document.getElementById("fc-main").style.mozAnimation = "fadesin 1.5s";
document.getElementById("fc-close").style.display = "block";
document.getElementById("fc-close").style.webkitAnimation = "fadesin 1.5s";
document.getElementById("fc-close").style.animation = "fadesin 1.5s";
document.getElementById("fc-close").style.mozAnimation = "fadesin 1.5s";
document.getElementById("fc-myFrame").style.display = "block";
document.getElementById("fc-myFrame").style.webkitAnimation = "fadesin 1.5s";
document.getElementById("fc-myFrame").style.animation = "fadesin 1.5s";
document.getElementById("fc-myFrame").style.mozAnimation = "fadesin 1.5s";
document.getElementById("fc-myFrame").src="https://www.flipcause.com/widget/"+cause_id;
}
}


function close_window() {
document.getElementById("fc-fade").style.display="none";
document.getElementById("fc-light").style.display="none";
document.getElementById("fc-main").style.display="none";
document.getElementById("fc-close").style.display="none";
document.getElementById("fc-myFrame").style.display="none";
}

</script>
<div class="fc-black_overlay" id="fc-fade" onclick="close_window()"></div>
<div class="fc-white_content" id="fc-light">
<div class="fc-main-box" id="fc-main">
<div class="fc-widget_close" id="fc-close" onclick="close_window()">
</div><iframe height="580" id="fc-myFrame" iframe="" scrolling="no" src="" style="border: 0;
border-radius:5px 5px 5px 5px; box-shadow:0 0 8px rgba(0, 0, 0, 0.5);" width="925"></iframe></div>
</div>
<!--END Flipcause Main Integration Code-->
</footer>
</html>